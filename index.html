<html>  
  <head>
    <title>gHost - unHosted Photo Album using WebRTC</title>
    <link href="css/lightbox.css" rel="stylesheet" />
    <link href="css/ghost.css" rel="stylesheet" />
    <link href="css/buttons.css" rel="stylesheet" />
    <link href='http://fonts.googleapis.com/css?family=Metal+Mania&text=gHost%20unHosted%20Photo%20Album' rel='stylesheet' type='text/css'>
    <script src="js/remoteStorage.js" type="text/javascript"></script>
    <script src="js/jquery-1.7.2.min.js" type="text/javascript"></script>
    <script src="remote.js" type="text/javascript"></script>
    <script src="helper.js" type="text/javascript"></script>
    <script src="app.js" type="text/javascript"></script>
    <script src="js/lightbox.js" type="text/javascript"></script>
    <script type="text/javascript">
      var picture_key = 0;
      var myStream;

      function init() {
        if (helper.isConnected()) {
          if (navigator.webkitGetUserMedia) navigator.webkitGetUserMedia({
            video: true
          }, onSuccess, onFail);
          else alert('webRTC is not available on this browser, so you can\'t take pictures. But you can still browse them if they are present in your unhosted account.');
        }
      }

      function onSuccess(stream) {
        myStream = stream;
        $('#camFeed').attr('src', webkitURL.createObjectURL(stream));
        $('#camFeed').css({
          'margin-top': '10px',
          'margin-bottom': '20px',
          'box-shadow': '0 0 50px 10px #fff'
        });
        $('#camerabox').fadeIn('slow')
      }

      function onFail() {
        alert('Could not connect to your webcam.');
      }

      if(window.location.href.indexOf('#access_token') > 0) {
        window.location.replace(location.protocol + '//' + location.host + location.pathname);
        var token = remoteStorage.receiveToken();
        console.log('Received an OAuth token: ' + token);
        localStorage.setItem('bearerToken', token);
        helper.setAuthorizedState(helper.isAuthorized());
      }
    </script>
    <script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
    <script type="text/javascript">stLight.options({publisher: "ur-9eeaca24-fff3-6d60-5473-7bb297154963"});</script>
  </head>
  
  <body>
    <center>
      <div id="splash">
        <img src="images/logo.png">
        <span class="title">gHost</span>
        <span class="subtitle">unHosted Photo Album</span>
      </div>
      <div id="login">
        <a id="question" href="#" onClick="window.open('http://unhosted.org/en/a/register.html','Get your remote storage','width=820,height=800,top=0,left=0');">?</a>
        <input type="text" id="userAddress" placeholder="user@remotestorage.com" onkeydown="if(event.keyCode == 13) document.getElementById('connect').click(); ">
        <button class="blue-pill" id="connect">Connect</button>
        <button class="blue-pill" id="disconnect" style="display: none">Disconnect</button>
        <br>

      </div>
      <div id="camerabox" style="display:none">
        <video id="camFeed" width="320" height="240" autoplay></video>
        <button class="blue-pill" id="takePhoto" style="display: none">Take Photo</button>
        <button class="blue-pill" id="savePhoto" style="display: none">Save Photo</button>
      </div>
      <img id="spinner" src="images/ajax-loader.gif" style="display:none">
      <div id="info">
	<p><b>gHost</b> is an experimental web application<br>
        based on HTML5, CSS3 and JavaScript.</p>
        <p><b>gHost</b> uses <a href="http://jquery.com/" target="_blank">JQuery</a> and two new great technologies called<br>
        <a href="http://www.webrtc.org/" target="_blank">WebRTC</a> and <a href="http://remotestoragejs.com/" target="_blank">RemoteStorageJS</a>;
        used, respectively,<br>to capture the webcam stream without plugins and<br>to host the pictures taken, leaving users in control of their data.</p>
        <p><b>gHost</b> is hosted on <a href="https://github.com/vcuculo/ghost-unhosted-webrtc" target="_blank">GitHub</a></p>
        <p style="font: 15px 'Courier New'">/* Author: Vittorio Cuculo */</p>
        <span class='st_facebook_large' displayText='Facebook'></span>
        <span class='st_twitter_large' displayText='Tweet'></span>
        <span class='st_googleplus_large' displayText='Google +'></span>
        <span class='st_pinterest_large' displayText='Pinterest'></span><br><br>
      </div>
    </center>
  </body>
</html>
